(()=>{"use strict";var e,t={1018:()=>{},1455:e=>{e.exports=window.wp.apiFetch},1609:e=>{e.exports=window.React},5209:function(e,t,o){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){n.default.logNotice(`AJAX request to endpoint: ${e}. â˜„ï¸`);const o=Object.assign({},t),r=a.default.getCheckoutParam("wc_ajax_url").toString().replace("%%endpoint%%",e);return o.url=`${r}&nocache=${(new Date).getTime()}`,o.dataType="json",o.cache=!1,o.error=[t.error,(t,o,r)=>{"abort"!==o&&n.default.logError(`cfwAjax ${e} Error: ${r} (${o})`)}].filter(Boolean).flat(),jQuery.ajax(o)};const a=r(o(6626)),n=r(o(8633))},5459:function(e,t,o){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(o(1609)),n=o(7761),c=r(o(9293)),u=r(o(8327));new class{constructor(){(0,n.cfwDomReady)(()=>{var e;(0,u.default)("cfw-post-purchase-root",a.default.createElement(c.default,null),null===(e=window.cfw_post_purchase_data)||void 0===e?void 0:e.current_bump)})}}},5482:(e,t,o)=>{o.d(t,{Cl:()=>r});var r=function(){return r=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var a in t=arguments[o])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},r.apply(this,arguments)};Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError},5795:e=>{e.exports=window.ReactDOM},6626:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class o{static initRunTimeParams(){cfw.runtime_params={}}static getSettings(){return cfw.settings}static getSetting(e){return!!cfw.settings[e]&&cfw.settings[e]}static getData(e){var t;return null!==(t=cfw.data[e])&&void 0!==t&&t}static updateData(e,t){cfw.data[e]=t}static getMessage(e){return cfw.messages[e]?cfw.messages[e]:""}static getCompatibilityClass(e){return cfw.compatibility[e]}static getElement(e){return cfw.elements[e]?jQuery(cfw.elements[e]):jQuery()}static getCheckoutParams(){return cfw.checkout_params}static getCheckoutParam(e){return cfw.checkout_params[e]?cfw.checkout_params[e]:null}static getRuntimeParameters(){return cfw.runtime_params}static getRuntimeParameter(e){return cfw.runtime_params[e]?cfw.runtime_params[e]:null}static setRuntimeParameter(e,t){cfw.runtime_params[e]=t}static get checkoutForm(){return o._checkoutForm}static set checkoutForm(e){this._checkoutForm=e}static getPostPurchaseData(){return cfw.post_purchase_data}}t.default=o},7761:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cfwDomReady=function(e){if("loading"!==document.readyState)e();else{const t=()=>{e(),document.removeEventListener("DOMContentLoaded",t)};document.addEventListener("DOMContentLoaded",t)}},t.cfwDefineScrollToNotices=function(){jQuery.scroll_to_notices=e=>{e.length&&jQuery("html, body").animate({scrollTop:e.offset().top-100},1e3)}}},8327:function(e,t,o){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,o=!0){const r=document.getElementById(e);r&&o&&(n.startsWith("18")?(0,a.createRoot)(r).render(t):(0,a.render)(t,r))};const a=o(3680),n=r(o(5795)).default.version||""},8633:function(e,t,o){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(o(6626)),n=r(o(5209));class c{static logError(e,t=null){c.log(`${e} âš ï¸`,!0,t),(0,n.default)("cfw_log_error",{type:"POST",data:{log_data:Object.assign({message:e},"object"==typeof t&&null!==t?t:{extraData:t})},dataType:"json",cache:!1})}static logNotice(e,t=null){c.log(`${e} â„¹ï¸`,!1,t)}static logEvent(e,t=null){c.log(`${e} ðŸ”ˆ`,!1,t)}static log(e,t=!1,o=null){(t||a.default.getCheckoutParam("cfw_debug_mode"))&&(console.log(`CheckoutWC: ${e}`),o&&console.log(o))}}t.default=c},8726:(e,t,o)=>{function r(e){return"[object Object]"===Object.prototype.toString.call(e)}function a(e){var t,o;return!1!==r(e)&&(void 0===(t=e.constructor)||!1!==r(o=t.prototype)&&!1!==o.hasOwnProperty("isPrototypeOf"))}o.d(t,{Q:()=>a})},9293:function(e,t,o){var r,a=this&&this.__createBinding||(Object.create?function(e,t,o,r){void 0===r&&(r=o);var a=Object.getOwnPropertyDescriptor(t,o);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,r,a)}:function(e,t,o,r){void 0===r&&(r=o),e[r]=t[o]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[t.length]=o);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o=r(e),c=0;c<o.length;c++)"default"!==o[c]&&a(t,e,o[c]);return n(t,e),t}),u=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(a,n){function c(e){try{l(r.next(e))}catch(e){n(e)}}function u(e){try{l(r.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(c,u)}l((r=r.apply(e,t||[])).next())})},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=c(o(1609)),d=o(5718),s=l(o(1455)),f=l(o(8633)),p=(e,t)=>{var o,r;f.default.logNotice(`AJAX request to endpoint: ${e}. â˜„ï¸`);const a=Object.assign({},t),n=window.cfw_post_purchase_data,c=null===(r=null===(o=null==n?void 0:n.checkout_params)||void 0===o?void 0:o.wc_ajax_url)||void 0===r?void 0:r.toString().replace("%%endpoint%%",e);return a.url=`${c}&nocache=${(new Date).getTime()}`,a.dataType="json",a.cache=!1,a.error=[t.error,(t,o,r)=>{"abort"!==o&&f.default.logError(`cfwAjax ${e} Error: ${r} (${o})`)}].filter(Boolean).flat(),jQuery.ajax(a)};t.default=()=>{f.default.logNotice("[CFW Post Purchase] Component mounting"),f.default.logNotice("[CFW Post Purchase] Initial window.cfw_post_purchase_data:",window.cfw_post_purchase_data);const[e,t]=(0,i.useState)(!0),[o,r]=(0,i.useState)(""),[a,n]=(0,i.useState)(!1),[c,l]=(0,i.useState)(!0),m=e=>{const t=jQuery(e.currentTarget),o=t.find(".single_variation_wrap .woocommerce-variation-price").html();o&&t.find(".cfw-product-form-modal-price").html(o)},_=e=>{e.preventDefault();const t=jQuery(e.currentTarget),o=t.find('button[type="submit"]');if(o.hasClass("loading")||o.prop("disabled"))return;o.prop("disabled",!0).addClass("loading");const r=t.serializeArray();let a=!1;jQuery.each(r,(e,t)=>"productID"!==t.name&&"add-to-cart"!==t.name||!t.value||(a=!0,!1));let n=!1;if(!a&&t.attr("action")){const e=t.attr("action").match(/add-to-cart=([0-9]+)/);n=!!e&&e[1]}return o.attr("name")&&"add-to-cart"===o.attr("name")&&o.attr("value")&&(n=o.attr("value")),n&&r.push({name:"add-to-cart",value:n}),o.addClass("loading"),jQuery(document.body).trigger("adding_to_cart",[o,r]),h(t,o,n,r)},h=(e,t,o,r)=>{const a=window.cfw_post_purchase_data;if(!a)return jQuery.Deferred().reject().promise();const n=e.find('input[name="cfw_ob_id"]').val()||a.current_bump.id,c=e.find('input[name="variation_id"]').val()||"0",u=e.find('input[name="quantity"]').val()||"1";return p("cfw_process_offer_payment",{type:"POST",data:{order_id:a.order.id,order_key:a.order.key,bump_id:n,product_id:o,variation_id:c,qty:u,_wpnonce:a.current_bump.nonce},dataType:"json",cache:!1}).done(e=>{if(t.removeClass("loading"),!e.success)return alert(e.message||"Payment failed. Please try again."),void t.prop("disabled",!1);jQuery(document.body).trigger("cfw_post_purchase_upsell_accepted",[e]),window.location.reload()}).fail((e,o,r)=>{t.removeClass("loading"),f.default.logError("Post-purchase payment failed:",r),window.location.href=a.thank_you_url})},g=()=>u(void 0,void 0,void 0,function*(){const e=window.cfw_post_purchase_data;if(e)try{yield p("cfw_decline_offer",{type:"POST",data:{bump_id:e.current_bump.id,order_id:e.order.id,order_key:e.order.key,_wpnonce:e.current_bump.nonce},dataType:"json"}),window.location.reload()}catch(t){f.default.logError("Error declining offer:",t),window.location.href=e.thank_you_url}});return(0,i.useEffect)(()=>{f.default.logNotice("[CFW Post Purchase] Initial mount, fetching bump content"),u(void 0,void 0,void 0,function*(){var e;f.default.logNotice("[CFW Post Purchase] fetchBumpContent called");const t=window.cfw_post_purchase_data;if(f.default.logNotice("[CFW Post Purchase] Bump data check:",{hasBumpData:!!t,hasCurrentBump:!!(null==t?void 0:t.current_bump),bumpData:t}),!t||!t.current_bump)return f.default.logNotice("[CFW Post Purchase] No bump data or current_bump found, aborting"),void l(!1);const o=t.current_bump.id,a=t.current_bump.full_screen;f.default.logNotice("[CFW Post Purchase] Fetching bump content:",{bumpId:o,isFullScreen:a}),n(a);try{let t="";t=a?`wp/v2/cfw_order_bumps/${o}`:`checkoutwc/v1/post-purchase-order-bump-upsell-product-form/${o}`,f.default.logNotice("[CFW Post Purchase] API fetch URL:",t);const n=yield(0,s.default)({path:t});f.default.logNotice("[CFW Post Purchase] API response received:",n),a&&(null===(e=n.content)||void 0===e?void 0:e.rendered)?(f.default.logNotice("[CFW Post Purchase] Setting full screen content"),r(n.content.rendered)):!a&&n.html?(f.default.logNotice("[CFW Post Purchase] Setting standard modal content"),r(n.html)):(f.default.logError("[CFW Post Purchase] Response missing expected content format",n),r("<p>Could not load offer content.</p>"))}catch(e){f.default.logError("Error fetching post-purchase bump content:",e),r("<p>Could not load offer content.</p>")}finally{f.default.logNotice("[CFW Post Purchase] Fetch complete"),l(!1)}});const e="cfw-post-purchase-modal";return f.default.logNotice("[CFW Post Purchase] Setting up event handlers"),jQuery(document.body).on(`submit.${e}`,`.${e} form.cfw-modal-order-bump-form`,_),jQuery(document.body).on(`woocommerce_variation_has_changed.${e}`,`.${e} form`,m),jQuery(document.body).on(`wc_variation_form.${e}`,`.${e} form`,m),jQuery(document.body).on(`show_variation.${e}`,m),jQuery(document.body).on(`show_variation.${e}`,(e,t,o)=>{const r=jQuery(".cfw-modal .single_add_to_cart_button");o?r.prop("disabled",!1):r.prop("disabled",!0)}),jQuery(document.body).on(`reset_data.${e}`,()=>{jQuery(".cfw-modal .single_add_to_cart_button").prop("disabled",!0)}),jQuery(document.body).on(`click.${e}`,`.${e} .cfw-bump-reject`,g),()=>{f.default.logNotice("[CFW Post Purchase] Component unmounting"),jQuery(document.body).off(`.${e}`)}},[]),(0,i.useEffect)(()=>{f.default.logNotice("[CFW Post Purchase] Content/loading state changed:",{isLoading:c,hasContent:!!o,contentLength:null==o?void 0:o.length}),!c&&o&&(f.default.logNotice("[CFW Post Purchase] Initializing variation forms"),setTimeout(()=>{const e=jQuery("form.cfw-product-form-modal.variable");f.default.logNotice("[CFW Post Purchase] Variable forms found:",e.length),e.length&&e.wc_variation_form()},100))},[c,o]),f.default.logNotice("[CFW Post Purchase] Render decision:",{isLoading:c,hasContent:!!o,isOpen:e}),c?(f.default.logNotice("[CFW Post Purchase] Rendering loading modal"),i.default.createElement(d.Modal,{open:e,onClose:()=>null,classNames:{root:"cfw-modal-root",overlay:"cfw-modal-overlay",modal:"cfw-modal cfw-post-purchase-modal-loading",modalContainer:"cfw-modal-container"},showCloseIcon:!1,focusTrapped:!1,blockScroll:!0,center:!0},i.default.createElement("div",{className:"cfw-modal-loading-spinner"},"Loading offer..."))):o?(f.default.logNotice("[CFW Post Purchase] Rendering full modal"),i.default.createElement(d.Modal,{open:e,onClose:()=>null,classNames:{root:"cfw-modal-root",overlay:"cfw-modal-overlay",modal:"cfw-modal cfw-grid cfw-post-purchase-modal "+(a?"cfw-full-screen":""),modalContainer:"cfw-modal-container"},showCloseIcon:!1,focusTrapped:!1,blockScroll:!0,center:!a},i.default.createElement("div",{dangerouslySetInnerHTML:{__html:o}}))):(f.default.logNotice("[CFW Post Purchase] No content, rendering null"),null)}}},o={};function r(e){var a=o[e];if(void 0!==a)return a.exports;var n=o[e]={exports:{}};return t[e].call(n.exports,n,n.exports,r),n.exports}r.m=t,e=[],r.O=(t,o,a,n)=>{if(!o){var c=1/0;for(d=0;d<e.length;d++){for(var[o,a,n]=e[d],u=!0,l=0;l<o.length;l++)(!1&n||c>=n)&&Object.keys(r.O).every(e=>r.O[e](o[l]))?o.splice(l--,1):(u=!1,n<c&&(c=n));if(u){e.splice(d--,1);var i=a();void 0!==i&&(t=i)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,a,n]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={751:0};r.O.j=t=>0===e[t];var t=(t,o)=>{var a,n,[c,u,l]=o,i=0;if(c.some(t=>0!==e[t])){for(a in u)r.o(u,a)&&(r.m[a]=u[a]);if(l)var d=l(r)}for(t&&t(o);i<c.length;i++)n=c[i],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(d)},o=globalThis.webpackChunkcheckout_for_woocommerce=globalThis.webpackChunkcheckout_for_woocommerce||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),r.O(void 0,[160],()=>r(5459));var a=r.O(void 0,[160],()=>r(1018));a=r.O(a)})();